<!DOCTYPE html>
<html lang='en'>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Calendar</title>
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/modalStyle.css">
        <link rel="stylesheet" href="css/calendarStyle.css">
    </head>
    
    <body> 
        <main>
            <navmenu></navmenu>

            <header>
                <h1 class="cal-title">Calendar</h1>
            </header>

            <dialog id="eventModalDialog" style=" top: calc(50% - 25vh);
            left: calc(50% - 25vw); border-radius: 15px;">

            <section class="modal" v-if="isEventModalOpen">
                <div class="flex">
                    <h2>{{ modalEvent.title }}</h2>
                    <button @click="closeModal" class="btn-close">⨉</button>
                </div>
                <p><strong>Start Date:</strong> {{ modalEvent.start }}</p>
                <p><strong>End Date:</strong> {{ modalEvent.end }}</p>
                <p><strong>Description:</strong> {{ modalEvent.description }}</p>
                <p><strong>Location:</strong> {{ modalEvent.location }}</p>
                <p><strong>Completed:</strong> {{ modalEvent.completed }}</p>
                
                <button @click="deleteEvent" class="remove-button">Delete</button>
            </section>
        </dialog>

        <dialog id="AssignmentModalDialog" style=" top: calc(50% - 25vh);
            left: calc(50% - 25vw); border-radius: 15px;">

            <section class="modal" v-if="isAssignmentModalOpen">
                <div class="flex">
                    <h2>{{ modalAssignment.title }}</h2>
                    <button @click="closeModal" class="btn-close">⨉</button>
                </div>
                <p><strong>Due Date:</strong> {{ modalAssignment.dueDate }}</p>
                <p><strong>Description:</strong> {{ modalAssignment.description }}</p>
                <p><strong>Course:</strong> {{ modalAssignment.courseName }}</p>
                <p><strong>Weight:</strong> {{ modalAssignment.weight }}</p>
                <button @click="deleteAssignment" class="remove-button">Delete</button>
            </section>

            </dialog>
            
            <dialog id="addEventModalDialog" style=" top: calc(50% - 25vh);
            left: calc(50% - 25vw); border-radius: 15px; max-height: 50vh;">
            <section class="modal" v-if="isAddEventModalOpen">
                <div class="flex">
                    <h2>Add Event</h2>
                    <button @click="closeModal" class="btn-close">⨉</button>
                </div>
                <form @submit.prevent="addEvent" class="vertical-form">
                    <p style="color: red; text-align: center" v-for="error in $store.state.error">{{ error }}</p>
                    <div class="form-group">
                        <label for="eventName">Event Name:</label>
                        <input type="text" id="eventName" v-model="eventName" required>
                    </div>
                    <div class="form-group">
                        <label for="startDate">Start Date:</label>
                        <input type="datetime-local" id="startDate" v-model="startDate" required>
                    </div>
                    <div class="form-group">
                        <label for="endDate">End Date:</label>
                        <input type="datetime-local" id="endDate" v-model="endDate" required>
                    </div>
                    <div class="form-group">
                        <label for="eventDescription">Event Description:</label>
                        <textarea id="eventDescription" v-model="eventDescription" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="location">Location:</label>
                        <input type="text" id="location" v-model="location" required>
                    </div>

                    <button type="submit" class="btn-add">Add Event</button>
                </form>
            </section>
            </dialog>
            
            <dialog id="addAssignmentModalDialog" style=" top: calc(50% - 25vh);
            left: calc(50% - 25vw); border-radius: 15px; max-height: 50vh;">
            <section class="modal" v-if="isAddAssignmentModalOpen">
                <div class="flex">
                    <h2>Add Assignment</h2>
                    <button @click="closeModal" class="btn-close">⨉</button>
                </div>
                <form @submit.prevent="addAssignment" class="vertical-form">
                    <p style="color: red; text-align: center" v-for="error in $store.state.error">{{ error }}</p>
                    <div class="form-group">
                        <label for="assignmentName">Assignment Name:</label>
                        <input type="text" id="assignmentName" v-model="assignmentName" required>
                    </div>
                    <div class="form-group">
                        <label for="dueDate">Due Date:</label>
                        <input type="datetime-local" id="dueDate" v-model="dueDate" required>
                    </div>
                    <div class="form-group">
                        <label for="assignmentDescription">Assignment Description:</label>
                        <textarea id="assignmentDescription" v-model="assignmentDescription" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="assignmentWeight">Weight:</label>
                        <input type="number" id="assignmentWeight" v-model="assignmentWeight" step="1" min="0" max="100" required pattern="[0-9]*">
                    </div>
                    <div class="form-group">
                        <label for="courseDropdown">Course:</label>
                        <select id="courseDropdown" v-model="selectedCourse" required>
                            <option value="" disabled>Select a course</option>
                            <option v-for="course in courses" :key="course.CourseID" :value="course.CourseID">{{ course.CourseCode }}</option>
                        </select>
                    </div>

                    <button type="submit" class="btn-add">Add Assignment</button>
                </form>
            </section>
            </dialog>
            
            <dialog id="paperSelectionDialog" style=" top: calc(50% - 25vh); left: calc(50% - 25vw); border-radius: 15px;">
                <section class="modal">
                <div class="flex">
                    <h2>Paper Selection</h2>
                    <button @click="closeModal" class="btn-close">⨉</button>
                </div>
                <div class="index-section1" style="display:grid; width:100%">
                    <fieldset class="input" id="paperSearch">
                        <legend>Add Papers</legend>
                        <p style="color: red; text-align: center" v-for="error in $store.state.error">{{ error }}</p>
                        <!--<form @submit.prevent="" class="form-container"> -->
                            <!--<label style="display: inline">Search Papers: </label>-->
                            <input type="text" id="paper-search" v-model="searchText" class="input-field" placeholder="Search papers...">
                            <div v-if="filteredCourses.length > 0">
                                <ul>
                                    <li v-for="course in filteredCourses" :key="course.CourseId" class="courselist-field">
                                        <label class="courselist-field">{{ course.CourseCode }}</label>
                                        <button @click.prevent="enrol(course.CourseId)" class="input" id="add-paper-btn">+</button>
                                        
                                    </li>
                                </ul>
                            </div>
                        <!--</form>-->
                    </fieldset>

                    <fieldset class="input">
                        <legend>Current Papers</legend>
                        <p style="color: red; text-align: center" v-for="error in $store.state.error">{{ error }}</p>
                        <div v-if="isEmptyCourseList()">
                            <label>You have no selected papers.</label>
                        </div>
                        <ul>
                        <li v-for="courseList in courseLists" class="courselist-field" >
                            <label class="courselist-field">{{ courseList.CourseCode }}</label>
                            <button class ="input" id="drop-paper-btn" @click="drop(courseList.CourseListID)">X</button>
                            
                        </li>
                        </ul>
                    </fieldset>
                </div>
                </section>
            </dialog>


            <div @click="closeModal" class="overlay hidden"></div>

             <div id="calendar-container"> <!-- Container for the calendar -->
            
                
                <div id="secondnav">
                    <button @click="addEventModal" id="secondnavbtn" >Add Event</button>
                    <button @click="addAssignmentModal" id="secondnavbtn">Add Assignment</button>
                    <button @click="paperSelectionModal" id="secondnavbtn">Add Paper</button>
                    <button v-if="$store.state.signedInUser.Status=='Teacher'" @click="addAssignmentModal" id="secondnavbtn">Add Assignment</button>


                </div>

                <hr class="headers-divder">
            
            <div id='calendar'></div> <!-- Calendar element -->
        </div>
        </main>


        <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js'></script>
        <script src="js/external/vue.global.js"></script>
        <script src="js/external/vuex.global.js"></script>
        <script src="js/external/vuex-persistedstate.js"></script>
        <script src="js/external/axios.js"></script>
        <script type="module" src="js/calendar.js"></script>
    </body>
</html>